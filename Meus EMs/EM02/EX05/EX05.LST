* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:59 Page   1
*                                       EX05.CBL
* Options: LIST(EX05.LST) ASMLIST(EX05.GRP)
     1 IDENTIFICATION DIVISION.
     2    PROGRAM-ID.      EX05.
     3    AUTHOR.   CLEDIR JUSTO.
     4    INSTALLATION.         FATEC-SP.
     5    DATE-WRITTEN.         27/04/2013.
     6    DATE-COMPILED. 28-Apr-13 12:59.
     7    SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT    DIVISION.
    10 CONFIGURATION SECTION.
    11    SOURCE-COMPUTER. IBM-PC.
    12    OBJECT-COMPUTER. IBM-PC.
    13    SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    14 INPUT-OUTPUT SECTION.
    15    FILE-CONTROL.
    16    SELECT ARQALU ASSIGN TO DISK
    17    ORGANIZATION IS LINE SEQUENTIAL.
    18    SELECT ARQREP ASSIGN TO DISK
    19    ORGANIZATION IS LINE SEQUENTIAL.
    20    SELECT RELAPROV ASSIGN TO DISK.
    21
    22 DATA    DIVISION.
    23 FILE SECTION.
    24
    25 FD  ARQALU
    26    LABEL RECORD ARE STANDARD
    27    VALUE OF FILE-ID IS "ARQALU.DAT".
    28    01 REG-ALU.
    29    02 MATRICULA-ENT.
    30      03 MATR                    PIC 9(06).
    31      03 DIGI                    PIC 9(01).
    32    02 NOME-ENT                  PIC X(30).
    33    02 NOTA1-ENT                 PIC 9(02)V9(02).
    34    02 NOTA2-ENT                 PIC 9(02)V9(02).
    35    02 NOTA3-ENT                 PIC 9(02)V9(02).
    36    02 FALTAS-ENT                PIC 9(02).
    37    02 SEXO-ENT                  PIC X(01).
    38
    39
    40 FD  ARQREP
    41    LABEL RECORD ARE STANDARD
    42    VALUE OF FILE-ID IS "ARQREP.DAT".
    43    01 REG-REP.
    44    02 MATRICULA-SAI             PIC 9(07).
    45    02 NOME-SAI                  PIC X(30).
    46    02 NOTA1-SAI                 PIC 9(02)V9(02).
    47    02 NOTA2-SAI                 PIC 9(02)V9(02).
    48    02 NOTA3-SAI                 PIC 9(02)V9(02).
    49    02 FALTAS-SAI                PIC 9(02).
    50    02 SEXO-SAI                  PIC X(01).
    51
    52 FD  RELAPROV
    53    LABEL RECORD IS OMITTED.
    54    01  REGAPROV     PIC X(80).
    55
    56 WORKING-STORAGE SECTION.
    57 77  FIM-ARQ            PIC X(03) VALUE "NAO".
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:59 Page   2
*                                       EX05.CBL
    58 77  CT-LIN             PIC 9(02) VALUE 30.
    59 77  CT-PAG             PIC 9(02) VALUE ZEROES.
    60 77  SOMA               PIC 9(03).
    61 77  MEDIA              PIC 9(02)V9(02).
    62 77  TOTAPROV           PIC 9(03) VALUE ZEROES.
    63 77  MEDIAGERAL         PIC 9(03)V9(02) VALUE ZEROES.
    64 77  MEDIATOT           PIC 9(03)V9(02) VALUE ZEROES.
    65
    66 01 CAB-01.
    67    02 FILLER    PIC X(21) VALUE SPACES.
    68    02 FILLER    PIC X(18) VALUE "RELACAO DE ALUNOS ".
    69    02 FILLER    PIC X(09) VALUE "APROVADOS".
    70    02 FILLER    PIC X(22) VALUE SPACES.
    71    02 FILLER    PIC X(05) VALUE "PAG. ".
    72    02 VAR-PAG   PIC 99.
    73    02 FILLER    PIC X(03) VALUE SPACES.
    74
    75
    76 01 CAB-02.
    77    02 FILLER    PIC X(05)  VALUE SPACES.
    78    02 FILLER    PIC X(06)  VALUE "NUMERO".
    79    02 FILLER    PIC X(17)  VALUE SPACES.
    80    02 FILLER    PIC X(13)  VALUE "NOME DO ALUNO".
    81    02 FILLER    PIC X(18) VALUE SPACES.
    82    02 FILLER    PIC X(05) VALUE "MEDIA".
    83    02 FILLER    PIC X(10)  VALUE SPACES.
    84    02 FILLER    PIC X(06) VALUE "FALTAS".
    85
    86
    87 01 CAB-03.
    88    02 FILLER    PIC X(05)  VALUE SPACES.
    89    02 FILLER    PIC X(26)  VALUE "TOTAL DE ALUNOS APROVADOS:".
    90    02 FILLER    PIC X(01)  VALUE SPACES.
    91    02 TOTAPRO   PIC 9(05).
    92
    93 01 CAB-04.
    94    02 FILLER    PIC X(05)  VALUE SPACES.
    95    02 FILLER    PIC X(21)  VALUE "MEDIA GERAL DA TURMA:".
    96    02 FILLER    PIC X(01)  VALUE SPACES.
    97    02 MEDIAGERA  PIC 9(03)V9(02).
    98
    99 01 CAB-05.
   100    02 FILLER    PIC X(80)  VALUE SPACES.
   101
   102
   103 01 DETALHE.
   104    02 FILLER    PIC X(05) VALUE SPACES.
   105    02 MAT       PIC 9(06).
   106    02 FILLER    PIC X(01) VALUE "-".
   107    02 DIG       PIC 9(01).
   108    02 FILLER    PIC X(18) VALUE SPACES.
   109    02 NOM       PIC X(30).
   110    02 FILLER    PIC X(5) VALUE SPACES.
   111    02 MEDI      PIC 9(02)V9(02).
   112    02 FILLER    PIC X(5) VALUE SPACES.
   113    02 FALT      PIC 9(02).
   114    02 FILLER    PIC X(5) VALUE SPACES.
   115
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:59 Page   3
*                                       EX05.CBL
   116 PROCEDURE DIVISION.
   117
   118 PGM-EX05.
   119    PERFORM INICIO.
   120    PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   121    PERFORM FIM.
   122    STOP RUN.
   123
   124 INICIO.
   125    OPEN INPUT  ARQALU
   126         OUTPUT ARQREP
   127                RELAPROV.
   128 PERFORM LEITURA.
   129
   130 LEITURA.
   131    READ ARQALU AT END MOVE "SIM" TO FIM-ARQ.
   132
   133 PRINCIPAL.
   134    PERFORM VERIFICACAO.
   135    PERFORM LEITURA.
   136
   137 VERIFICACAO.
   138    ADD NOTA1-ENT NOTA2-ENT NOTA3-ENT GIVING SOMA.
   139    DIVIDE SOMA BY 3 GIVING MEDIA.
   140    IF MEDIA NOT< 7 AND FALTAS-ENT < 16
   141        PERFORM IMPRESSAO.
   142    IF MEDIA NOT> 7 OR FALTAS-ENT > 15
   143        PERFORM REPROVADO.
   144
   145 REPROVADO.
   146    MOVE MATRICULA-ENT TO MATRICULA-SAI.
   147    MOVE NOME-ENT TO NOME-SAI.
   148    MOVE NOTA1-ENT TO NOTA1-SAI.
   149    MOVE NOTA2-ENT TO NOTA2-SAI.
   150    MOVE NOTA3-ENT TO NOTA3-SAI.
   151    MOVE FALTAS-ENT TO FALTAS-SAI.
   152    MOVE SEXO-ENT TO SEXO-SAI.
   153    WRITE REG-REP.
   154
   155
   156 IMPRESSAO.
   157    IF CT-LIN GREATER THAN 29
   158        PERFORM CABECALHO.
   159        PERFORM IMPDET.
   160
   161 IMPDET.
   162    ADD NOTA1-ENT NOTA2-ENT NOTA3-ENT GIVING SOMA.
   163    DIVIDE SOMA BY 3 GIVING MEDIA
   164    MOVE MATR TO MAT.
   165    MOVE DIGI TO DIG.
   166    MOVE NOME-ENT TO NOM.
   167    MOVE MEDIA TO MEDI.
   168    MOVE FALTAS-ENT TO FALT.
   169    ADD 1 TO TOTAPROV.
   170    ADD MEDIA TO MEDIAGERAL.
   171    WRITE REGAPROV FROM DETALHE AFTER ADVANCING 1 LINE.
   172    ADD 1 TO CT-LIN.
   173
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:59 Page   4
*                                       EX05.CBL
   174 CABECALHO.
   175    ADD 1 TO CT-PAG.
   176    MOVE CT-PAG TO VAR-PAG.
   177    MOVE SPACES TO REGAPROV.
   178    WRITE REGAPROV AFTER ADVANCING PAGE.
   179    WRITE REGAPROV FROM CAB-01 AFTER ADVANCING 1 LINE.
   180    WRITE REGAPROV FROM CAB-02 AFTER ADVANCING 2 LINES.
   181    WRITE REGAPROV FROM CAB-05 AFTER ADVANCING 2 LINES.
   182    MOVE ZEROES TO CT-LIN.
   183
   184
   185 FIM.
   186    MOVE TOTAPROV TO TOTAPRO.
   187    WRITE REGAPROV FROM CAB-03 AFTER ADVANCING 1 LINES.
   188    DIVIDE MEDIAGERAL BY TOTAPROV GIVING MEDIATOT.
   189    MOVE MEDIATOT TO MEDIAGERA.
   190    WRITE REGAPROV FROM CAB-04 AFTER ADVANCING 1 LINES.
   191    CLOSE ARQALU
   192          ARQREP
   193          RELAPROV.
   194
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1776     Code:         921     Dictionary:        2698
