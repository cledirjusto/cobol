* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:39 Page   1
*                                       EX04.CBL
* Options: LIST(EX04.LST) ASMLIST(EX04.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.      EX04.
     3 AUTHOR.          CLEDIR JUSTO.
     4 INSTALLATION.    FATEC-SP.
     5 DATE-WRITTEN.    27/04/2013.
     6 DATE-COMPILED. 28-Apr-13 12:39.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11 SOURCE-COMPUTER. IBM-PC.
    12 OBJECT-COMPUTER. IBM-PC.
    13 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
    16     SELECT CADESTOQ ASSIGN TO DISK
    17     ORGANIZATION IS LINE SEQUENTIAL.
    18     SELECT RELESTOQ ASSIGN TO DISK.
    19
    20 DATA DIVISION.
    21 FILE SECTION.
    22
    23 FD  CADESTOQ
    24     LABEL RECORD ARE STANDARD
    25     VALUE OF FILE-ID IS "CADESTOQ.DAT".
    26 01  REG-CLI.
    27     02 CODIGO            PIC 9(05).
    28     02 NOME              PIC X(15).
    29     02 QTD-ESTOQUE       PIC 9(5).
    30     02 PRECO             PIC 9(6)V99.
    31
    32 FD  RELESTOQ
    33     LABEL RECORD IS OMITTED.
    34 01  REG-ATR     PIC X(80).
    35
    36 WORKING-STORAGE SECTION.
    37 77  FIM-ARQ     PIC X(03) VALUE "NAO".
    38 77  CT-LIN      PIC 9(02) VALUE 25.
    39 77  CT-PAG      PIC 9(02) VALUE ZEROES.
    40 77  CUSTOTOT    PIC 9(07)V9(02) VALUE ZEROES.
    41 77  QTDTOTAL    PIC 9(07) VALUE ZEROES.
    42 77  PRECOTOTAL  PIC 9(08)V9(02) VALUE ZEROES.
    43 77  PRECOMEDIO  PIC 9(06)V9(02) VALUE ZEROES.
    44
    45
    46 01 CAB-01.
    47    02 FILLER    PIC X(08) VALUE "27/04/13".
    48    02 FILLER    PIC X(05) VALUE SPACES.
    49    02 FILLER    PIC X(22) VALUE "RELATORIO DE MATERIAL ".
    50    02 FILLER    PIC X(10) VALUE "EM ESTOQUE".
    51    02 FILLER    PIC X(20) VALUE SPACES.
    52    02 FILLER    PIC X(05) VALUE "PAG. ".
    53    02 VAR-PAG   PIC 99.
    54    02 FILLER    PIC X(03) VALUE SPACES.
    55
    56 01 CAB-02.
    57    02 FILLER    PIC X(6)  VALUE "CODIGO".
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:39 Page   2
*                                       EX04.CBL
    58    02 FILLER    PIC X(5) VALUE SPACES.
    59    02 FILLER    PIC X(4)  VALUE "NOME".
    60    02 FILLER    PIC X(17) VALUE SPACES.
    61    02 FILLER    PIC X(06) VALUE "QTD DO".
    62    02 FILLER    PIC X(5)  VALUE SPACES.
    63    02 FILLER    PIC X(14) VALUE "CUSTO UNITARIO".
    64    02 FILLER    PIC X(5)  VALUE SPACES.
    65    02 FILLER    PIC X(11) VALUE "CUSTO TOTAL".
    66
    67
    68 01 CAB-03.
    69    02 FILLER    PIC X(32) VALUE SPACES.
    70    02 FILLER    PIC X(07) VALUE "ESTOQUE".
    71    02 FILLER    PIC X(41) VALUE SPACES.
    72
    73 01 CAB-04.
    74    02 FILLER    PIC X(05) VALUE SPACES.
    75    02 FILLER    PIC X(16) VALUE "QUANTIDADE TOTAL".
    76    02 FILLER    PIC X(16) VALUE SPACES.
    77    02 FILLER    PIC X(11) VALUE "PRECO MEDIO".
    78    02 FILLER    PIC X(17) VALUE SPACES.
    79    02 FILLER    PIC X(11) VALUE "PRECO TOTAL".
    80
    81 01 CAB-05.
    82    02 FILLER    PIC X(10) VALUE SPACES.
    83    02 QTDTOTA   PIC 9(07).
    84    02 FILLER    PIC X(20) VALUE SPACES.
    85    02 PRECOMEDI PIC 9(06)V9(02).
    86    02 FILLER    PIC X(20) VALUE SPACES.
    87    02 PRECOTOTA  PIC 9(08)V9(02).
    88
    89
    90 01 DETALHE.
    91    02 COD       PIC 9(05).
    92    02 FILLER    PIC X(06) VALUE SPACES.
    93    02 NOM       PIC X(15).
    94    02 FILLER    PIC X(6) VALUE SPACES.
    95    02 QTDEST    PIC 9(5).
    96    02 FILLER    PIC X(10) VALUE SPACES.
    97    02 PREC      PIC 9(6)V99.
    98    02 FILLER    PIC X(10) VALUE SPACES.
    99    02 CUSTOTO   PIC 9(07)V9(02).
   100
   101
   102 PROCEDURE             DIVISION.
   103
   104 PGM-EX04.
   105    PERFORM INICIO.
   106    PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   107    PERFORM FIM.
   108    STOP RUN.
   109
   110 INICIO.
   111    OPEN INPUT  CADESTOQ
   112         OUTPUT RELESTOQ.
   113    PERFORM LEITURA.
   114
   115 LEITURA.
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:39 Page   3
*                                       EX04.CBL
   116    READ CADESTOQ AT END MOVE "SIM" TO FIM-ARQ.
   117
   118 PRINCIPAL.
   119    PERFORM IMPRESSAO.
   120    PERFORM LEITURA.
   121
   122
   123 IMPRESSAO.
   124    IF CT-LIN GREATER THAN 24
   125        PERFORM CABECALHO.
   126    PERFORM IMPDET.
   127
   128 IMPDET.
   129    MOVE CODIGO TO COD.
   130    MOVE NOME TO NOM.
   131    MOVE QTD-ESTOQUE TO QTDEST.
   132    MOVE PRECO TO PREC.
   133    MULTIPLY PRECO BY QTD-ESTOQUE GIVING CUSTOTOT.
   134    MOVE CUSTOTOT TO CUSTOTO.
   135    WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   136    ADD 1 TO CT-LIN.
   137    ADD QTD-ESTOQUE TO QTDTOTAL.
   138    ADD CUSTOTOT TO PRECOTOTAL.
   139
   140 CABECALHO.
   141    ADD 1 TO CT-PAG.
   142    MOVE CT-PAG TO VAR-PAG.
   143    MOVE SPACES TO REG-ATR.
   144    WRITE REG-ATR AFTER ADVANCING PAGE.
   145    WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   146    WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 3 LINES.
   147    WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 1 LINES.
   148    MOVE ZEROES TO CT-LIN.
   149
   150
   151 FIM.
   152    DIVIDE PRECOTOTAL BY QTDTOTAL GIVING PRECOMEDIO.
   153     ADD 1 TO CT-PAG.
   154    MOVE CT-PAG TO VAR-PAG.
   155    MOVE SPACES TO REG-ATR.
   156    WRITE REG-ATR AFTER ADVANCING PAGE.
   157    WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   158    WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 1 LINE.
   159    MOVE QTDTOTAl TO QTDTOTA.
   160    MOVE PRECOMEDIo TO PRECOMEDI.
   161    MOVE PRECOTOTAl TO PRECOTOTA.
   162    WRITE REG-ATR FROM CAB-05 AFTER ADVANCING 1 LINE.
   163    CLOSE CADESTOQ
   164          RELESTOQ.
   165
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1624     Code:         766     Dictionary:        1995
