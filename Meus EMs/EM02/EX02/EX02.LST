* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:14 Page   1
*                                       EX02.CBL
* Options: LIST(EX02.LST) ASMLIST(EX02.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.      EX02.
     3 AUTHOR.          CLEDIR JUSTO.
     4 INSTALLATION.    FATEC-SP.
     5 DATE-WRITTEN.    21/04/2013.
     6 DATE-COMPILED. 28-Apr-13 12:14.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11 SOURCE-COMPUTER. IBM-PC.
    12 OBJECT-COMPUTER. IBM-PC.
    13 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
    16     SELECT CADCLI ASSIGN TO DISK
    17     ORGANIZATION IS LINE SEQUENTIAL.
    18     SELECT RELCLI ASSIGN TO DISK.
    19
    20 DATA DIVISION.
    21 FILE SECTION.
    22
    23 FD  CADCLI
    24     LABEL RECORD ARE STANDARD
    25     VALUE OF FILE-ID IS "CADCLI.DAT".
    26 01  REG-CLI.
    27     02 CPF         PIC 9(11).
    28     02 NOME-ENT    PIC X(30).
    29     02 ESTADO-ENT  PIC X(02).
    30     02 CIDADE      PIC X(30).
    31     02 REG-TELEFONE.
    32        03 PREFIX   PIC 9(04).
    33        03 NUMERO   PIC 9(04).
    34     02 DATA-ENT.
    35        03 DDD      PIC 9(02).
    36        03 MMM      PIC 9(02).
    37        03 AAAA     PIC 9(04).
    38
    39 FD  RELCLI
    40     LABEL RECORD IS OMITTED.
    41 01  REG-ATR     PIC X(80).
    42
    43 WORKING-STORAGE SECTION.
    44 77  FIM-ARQ     PIC X(03) VALUE "NAO".
    45 77  CT-LIN      PIC 9(02) VALUE 25.
    46 77  CT-PAG      PIC 9(02) VALUE ZEROES.
    47 77  TOTALCLI    PIC 9(04) VALUE ZEROES.
    48
    49 01 CAB-01.
    50    02 FILLER    PIC X(70) VALUE SPACES.
    51    02 FILLER    PIC X(05) VALUE "PAG. ".
    52    02 VAR-PAG   PIC 99.
    53    02 FILLER    PIC X(03) VALUE SPACES.
    54
    55 01 CAB-02.
    56    02 FILLER    PIC X(31) VALUE SPACES.
    57    02 FILLER    PIC X(17) VALUE "TURISMAR TURISMOS".
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:14 Page   2
*                                       EX02.CBL
    58    02 FILLER    PIC X(32) VALUE SPACES.
    59
    60 01 CAB-03.
    61    02 FILLER    PIC X(23) VALUE SPACES.
    62    02 FILLER    PIC X(20) VALUE "CLIENTES NO PERIODO ".
    63    02 FILLER    PIC X(14) VALUE "DE 2010 A 2011".
    64    02 FILLER    PIC X(19) VALUE SPACES.
    65
    66 01 CAB-04.
    67    02 FILLER    PIC X(10)  VALUE SPACES.
    68    02 FILLER    PIC X(4)  VALUE "NOME".
    69    02 FILLER    PIC X(20) VALUE SPACES.
    70    02 FILLER    PIC X(6)  VALUE "ESTADO".
    71    02 FILLER    PIC X(20) VALUE SPACES.
    72    02 FILLER    PIC X(08) VALUE "TELEFONE".
    73    02 FILLER    PIC X(05)  VALUE SPACES.
    74
    75 01 CAB-05.
    76    02 FILLER    PIC X(30) VALUE "------------------------------".
    77    02 FILLER    PIC X(30) VALUE "------------------------------".
    78    02 FILLER    PIC X(20) VALUE "--------------------".
    79
    80 01 CAB-06.
    81    02 FILLER    PIC X(19) VALUE "Total de Clientes: ".
    82    02 TOTCL     PIC 9(04).
    83    02 FILLER    PIC X(57) VALUE SPACES.
    84
    85 01 DETALHE.
    86
    87    02 NOM       PIC X(30).
    88    02 FILLER    PIC X(05) VALUE SPACES.
    89    02 EST       PIC X(02).
    90    02 FILLER    PIC X(23) VALUE SPACES.
    91    02 TELEF     PIC 9(04).
    92    02 FILLER    PIC X(01) VALUE "-".
    93    02 TELEF2    PIC 9(04).
    94
    95
    96 PROCEDURE             DIVISION.
    97
    98 PGM-EX02.
    99    PERFORM INICIO.
   100    PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   101    PERFORM FIM.
   102    STOP RUN.
   103
   104 INICIO.
   105    OPEN INPUT  CADCLI
   106         OUTPUT RELCLI.
   107    PERFORM LEITURA.
   108
   109 LEITURA.
   110    READ CADCLI AT END MOVE "SIM" TO FIM-ARQ.
   111
   112 PRINCIPAL.
   113    PERFORM VERIFICACAO.
   114    PERFORM LEITURA.
   115
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Apr-13 12:14 Page   3
*                                       EX02.CBL
   116 VERIFICACAO.
   117 IF AAAA NOT<2011 and NOT>2012
   118    PERFORM IMPRESSAO.
   119
   120 IMPRESSAO.
   121    IF CT-LIN GREATER THAN 24
   122        PERFORM CABECALHO.
   123    PERFORM IMPDET.
   124
   125 IMPDET.
   126    MOVE NOME-ENT TO NOM.
   127    MOVE ESTADO-ENT TO EST.
   128    MOVE PREFIX     TO TELEF.
   129    MOVE NUMERO     TO TELEF2.
   130    WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   131    ADD 1 TO CT-LIN.
   132    ADD 1 TO TOTALCLI.
   133
   134 CABECALHO.
   135    ADD 1 TO CT-PAG.
   136    MOVE CT-PAG TO VAR-PAG.
   137    MOVE SPACES TO REG-ATR.
   138    WRITE REG-ATR AFTER ADVANCING PAGE.
   139    WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   140    WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 1 LINES.
   141    WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 2 LINES.
   142    WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 2 LINES.
   143    WRITE REG-ATR FROM CAB-05 AFTER ADVANCING 1 LINES.
   144    MOVE ZEROES TO CT-LIN.
   145
   146
   147 FIM.
   148    MOVE TOTALCLI TO TOTCL.
   149    WRITE REG-ATR FROM CAB-06 AFTER ADVANCING 1 LINES.
   150    CLOSE CADCLI
   151          RELCLI.
   152
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1716     Code:         697     Dictionary:        1996
