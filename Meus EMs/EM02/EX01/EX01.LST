* Microsoft COBOL Version 4.5        L2.4 revision 002 21-Apr-13 16:18 Page   1
*                                       EX01.CBL
* Options: LIST(EX01.LST) ASMLIST(EX01.GRP)
     1 IDENTIFICATION DIVISION.
     2    PROGRAM-ID.      EX01.
     3    AUTHOR.   CLEDIR JUSTO.
     4    INSTALLATION.         FATEC-SP.
     5    DATE-WRITTEN.         21/04/2013.
     6    DATE-COMPILED. 21-Apr-13 16:18.
     7    SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT    DIVISION.
    10 CONFIGURATION SECTION.
    11    SOURCE-COMPUTER. IBM-PC.
    12    OBJECT-COMPUTER. IBM-PC.
    13    SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    14 INPUT-OUTPUT SECTION.
    15    FILE-CONTROL.
    16    SELECT CADSOC1 ASSIGN TO DISK
    17    ORGANIZATION IS LINE SEQUENTIAL.
    18    SELECT CADSOC2 ASSIGN TO DISK
    19    ORGANIZATION IS LINE SEQUENTIAL.
    20    SELECT RELSOCIO ASSIGN TO DISK.
    21
    22 DATA    DIVISION.
    23 FILE SECTION.
    24
    25 FD  CADSOC1
    26    LABEL RECORD ARE STANDARD
    27    VALUE OF FILE-ID IS "CADSOC1.DAT".
    28    01 REG-SOC1.
    29    02 CODIGO-PAGAMENTO1     PIC 9(02).
    30    02 NUMERO-SOCIO1         PIC 9(06).
    31    02 NOME-SOCIO1           PIC X(30).
    32    02 VALOR-PAGAMENTO1      PIC 9(09)V9(02).
    33
    34 FD  CADSOC2
    35    LABEL RECORD ARE STANDARD
    36    VALUE OF FILE-ID IS "CADSOC2.DAT".
    37    01 REG-SOC2.
    38    02 NUMERO-SOCIO2         PIC 9(06).
    39    02 NOME-SOCIO2           PIC X(30).
    40    02 VALOR-PAGAMENTO2      PIC 9(09)V9(02).
    41
    42 FD  RELSOCIO
    43    LABEL RECORD IS OMITTED.
    44    01  REGSOCIO     PIC X(80).
    45
    46 WORKING-STORAGE SECTION.
    47 77  FIM-ARQ            PIC X(03) VALUE "NAO".
    48 77  CT-LIN             PIC 9(02) VALUE 30.
    49 77  CT-PAG             PIC 9(02) VALUE ZEROES.
    50 77  VALOR-TOTAL        PIC 9(12)V9(02) VALUE ZEROES.
    51 77  TOTAL-SOCIOS       PIC 9(05) VALUE ZEROES.
    52
    53 01 CAB-01.
    54    02 FILLER    PIC X(70) VALUE SPACES.
    55    02 FILLER    PIC X(05) VALUE "PAG. ".
    56    02 VAR-PAG   PIC 99.
    57    02 FILLER    PIC X(03) VALUE SPACES.
* Microsoft COBOL Version 4.5        L2.4 revision 002 21-Apr-13 16:18 Page   2
*                                       EX01.CBL
    58
    59 01 CAB-02.
    60    02 FILLER    PIC X(80) VALUE SPACES.
    61
    62 01 CAB-03.
    63    02 FILLER    PIC X(25) VALUE SPACES.
    64    02 FILLER    PIC X(28) VALUE "RELACAO DE SOCIOS ATRASADOS".
    65    02 FILLER    PIC X(27) VALUE SPACES.
    66
    67 01 CAB-04.
    68    02 FILLER    PIC X(80) VALUE SPACES.
    69
    70 01 CAB-05.
    71    02 FILLER    PIC X(05)  VALUE SPACES.
    72    02 FILLER    PIC X(15)  VALUE "NUMERO DO SOCIO".
    73    02 FILLER    PIC X(12)  VALUE SPACES.
    74    02 FILLER    PIC X(13)  VALUE "NOME DO SOCIO".
    75    02 FILLER    PIC X(12) VALUE SPACES.
    76    02 FILLER    PIC X(18) VALUE "VALOR DO PAGAMENTO".
    77    02 FILLER    PIC X(05)  VALUE SPACES.
    78
    79 01 CAB-06.
    80    02 FILLER    PIC X(80) VALUE SPACES.
    81
    82 01 CAB-07.
    83    02 FILLER    PIC X(05)  VALUE SPACES.
    84    02 FILLER    PIC X(26)  VALUE "TOTAL DE SOCIOS ATRASADOS:".
    85    02 FILLER    PIC X(03)  VALUE SPACES.
    86    02 TOT       PIC 9(05).
    87
    88 01 CAB-08.
    89    02 FILLER    PIC X(05)  VALUE SPACES.
    90    02 FILLER    PIC X(21)  VALUE "VALOR TOTAL ATRASADO:".
    91    02 FILLER    PIC X(03)  VALUE SPACES.
    92    02 ATRASADO  PIC 9(12)V9(02).
    93
    94
    95 01 DETALHE.
    96    02 FILLER    PIC X(05) VALUE SPACES.
    97    02 NUM       PIC 9(06).
    98    02 FILLER    PIC X(21) VALUE SPACES.
    99    02 NOM       PIC X(30).
   100    02 FILLER    PIC X(1) VALUE SPACES.
   101    02 VALOR     PIC 9(09)V9(02).
   102    02 FILLER    PIC X(1) VALUE SPACES.
   103
   104 PROCEDURE DIVISION.
   105
   106 PGM-EX01.
   107    PERFORM INICIO.
   108    PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   109    PERFORM FIM.
   110    STOP RUN.
   111
   112 INICIO.
   113    OPEN INPUT  CADSOC1
   114         OUTPUT CADSOC2
   115                RELSOCIO.
* Microsoft COBOL Version 4.5        L2.4 revision 002 21-Apr-13 16:18 Page   3
*                                       EX01.CBL
   116 PERFORM LEITURA.
   117
   118 LEITURA.
   119    READ CADSOC1 AT END MOVE "SIM" TO FIM-ARQ.
   120
   121 PRINCIPAL.
   122    PERFORM VERIFICACAO.
   123    PERFORM LEITURA.
   124
   125 VERIFICACAO.
   126    IF CODIGO-PAGAMENTO1 EQUAL TO 01
   127        PERFORM EMDIA.
   128    IF CODIGO-PAGAMENTO1 EQUAL TO 02
   129        PERFORM IMPRESSAO.
   130
   131 EMDIA.
   132    MOVE NUMERO-SOCIO1 TO NUMERO-SOCIO2.
   133    MOVE NOME-SOCIO1 TO NOME-SOCIO2.
   134    MOVE VALOR-PAGAMENTO1 TO VALOR-PAGAMENTO2.
   135    WRITE REG-SOC2.
   136
   137
   138 IMPRESSAO.
   139    IF CT-LIN GREATER THAN 29
   140        PERFORM CABECALHO.
   141        PERFORM IMPDET.
   142
   143 IMPDET.
   144    MOVE NUMERO-SOCIO1 TO NUM.
   145    MOVE NOME-SOCIO1   TO NOM.
   146    MOVE VALOR-PAGAMENTO1 TO VALOR.
   147    ADD 1 TO TOTAL-SOCIOS.
   148    ADD VALOR-PAGAMENTO1 TO VALOR-TOTAL.
   149    WRITE REGSOCIO FROM DETALHE AFTER ADVANCING 1 LINE.
   150    ADD 1 TO CT-LIN.
   151
   152 CABECALHO.
   153    ADD 1 TO CT-PAG.
   154    MOVE CT-PAG TO VAR-PAG.
   155    MOVE SPACES TO REGSOCIO.
   156    WRITE REGSOCIO AFTER ADVANCING PAGE.
   157    WRITE REGSOCIO FROM CAB-01 AFTER ADVANCING 1 LINE.
   158    WRITE REGSOCIO FROM CAB-02 AFTER ADVANCING 1 LINES.
   159    WRITE REGSOCIO FROM CAB-03 AFTER ADVANCING 1 LINES.
   160    WRITE REGSOCIO FROM CAB-04 AFTER ADVANCING 1 LINES.
   161    WRITE REGSOCIO FROM CAB-05 AFTER ADVANCING 1 LINES.
   162    WRITE REGSOCIO FROM CAB-06 AFTER ADVANCING 1 LINES.
   163    MOVE ZEROES TO CT-LIN.
   164
   165
   166 FIM.
   167    WRITE REGSOCIO FROM CAB-02 AFTER ADVANCING 1 LINES.
   168    MOVE TOTAL-SOCIOS TO TOT.
   169    WRITE REGSOCIO FROM CAB-07 AFTER ADVANCING 1 LINES.
   170    MOVE VALOR-TOTAL TO ATRASADO.
   171    WRITE REGSOCIO FROM CAB-08 AFTER ADVANCING 1 LINES.
   172    CLOSE CADSOC1
   173          CADSOC2
* Microsoft COBOL Version 4.5        L2.4 revision 002 21-Apr-13 16:18 Page   4
*                                       EX01.CBL
   174          RELSOCIO.
   175
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        2008     Code:         956     Dictionary:        2397
