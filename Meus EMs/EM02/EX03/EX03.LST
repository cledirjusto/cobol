* Microsoft COBOL Version 4.5        L2.4 revision 002 27-Apr-13 13:14 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.      EX03.
     3 AUTHOR.          CLEDIR JUSTO.
     4 INSTALLATION.    FATEC-SP.
     5 DATE-WRITTEN.    27/04/2013.
     6 DATE-COMPILED. 27-Apr-13 13:14.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11 SOURCE-COMPUTER. IBM-PC.
    12 OBJECT-COMPUTER. IBM-PC.
    13 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
    16     SELECT CADENT ASSIGN TO DISK
    17     ORGANIZATION IS LINE SEQUENTIAL.
    18     SELECT RELSAI ASSIGN TO DISK.
    19
    20 DATA DIVISION.
    21 FILE SECTION.
    22
    23 FD  CADENT
    24     LABEL RECORD ARE STANDARD
    25     VALUE OF FILE-ID IS "CADENT.DAT".
    26 01  REG-CLI.
    27     02 CODIGO      PIC 9(07).
    28     02 NOME-ENT    PIC X(30).
    29     02 SALARIO     PIC 9(5)V9(2).
    30     02 SEXO        PIC X(1).
    31
    32 FD  RELSAI
    33     LABEL RECORD IS OMITTED.
    34 01  REG-ATR     PIC X(80).
    35
    36 WORKING-STORAGE SECTION.
    37 77  FIM-ARQ     PIC X(03) VALUE "NAO".
    38 77  CT-LIN      PIC 9(02) VALUE 20.
    39 77  CT-PAG      PIC 9(02) VALUE ZEROES.
    40 77  TOTCLI      PIC 9(05) VALUE ZEROES.
    41 77  TOTSAL      PIC 9(09)V9(02).
    42
    43 01 CAB-01.
    44    02 FILLER    PIC X(70) VALUE SPACES.
    45    02 FILLER    PIC X(05) VALUE "PAG. ".
    46    02 VAR-PAG   PIC 99.
    47    02 FILLER    PIC X(03) VALUE SPACES.
    48
    49 01 CAB-02.
    50    02 FILLER    PIC X(21) VALUE SPACES.
    51    02 FILLER    PIC X(25) VALUE "LISTAGEM DOS CLIENTES DO ".
    52    02 FILLER    PIC X(13) VALUE "SEXO FEMININO".
    53    02 FILLER    PIC X(21) VALUE SPACES.
    54
    55 01 CAB-03.
    56    02 FILLER    PIC X(23) VALUE SPACES.
    57    02 FILLER    PIC X(23) VALUE "COM SALARIOS SUPERIORES".
* Microsoft COBOL Version 4.5        L2.4 revision 002 27-Apr-13 13:14 Page   2
*                                       EX03.CBL
    58    02 FILLER    PIC X(11) VALUE " A 5.000,00".
    59    02 FILLER    PIC X(23) VALUE SPACES.
    60
    61 01 CAB-04.
    62    02 FILLER    PIC X(10)  VALUE SPACES.
    63    02 FILLER    PIC X(6)  VALUE "CODIGO".
    64    02 FILLER    PIC X(14) VALUE SPACES.
    65    02 FILLER    PIC X(4)  VALUE "NOME".
    66    02 FILLER    PIC X(26) VALUE SPACES.
    67    02 FILLER    PIC X(07) VALUE "SALARIO".
    68    02 FILLER    PIC X(13)  VALUE SPACES.
    69
    70 01 CAB-05.
    71    02 FILLER    PIC X(18) VALUE "Total de Clientes ".
    72    02 FILLER    PIC X(11) VALUE "impressos: ".
    73    02 TOTCL     PIC 9(04).
    74    02 FILLER    PIC X(47) VALUE SPACES.
    75
    76 01 CAB-06.
    77    02 FILLER    PIC X(19) VALUE "Total de Salarios: ".
    78    02 TOTSA     PIC 9(09)V9(02).
    79    02 FILLER    PIC X(50) VALUE SPACES.
    80
    81 01 DETALHE.
    82    02 FILLER    PIC X(10)  VALUE SPACES.
    83    02 COD       PIC 9(07).
    84    02 FILLER    PIC X(05) VALUE SPACES.
    85    02 NOM       PIC X(30).
    86    02 FILLER    PIC X(10) VALUE SPACES.
    87    02 SAL       PIC 9(5)V9(2).
    88
    89
    90 PROCEDURE             DIVISION.
    91
    92 PGM-EX03.
    93    PERFORM INICIO.
    94    PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    95    PERFORM FIM.
    96    STOP RUN.
    97
    98 INICIO.
    99    OPEN INPUT  CADENT
   100         OUTPUT RELSAI.
   101    PERFORM LEITURA.
   102
   103 LEITURA.
   104    READ CADENT AT END MOVE "SIM" TO FIM-ARQ.
   105
   106 PRINCIPAL.
   107    IF SALARIO NOT< 5000 and SEXO = "F"
   108    PERFORM IMPRESSAO.
   109    PERFORM LEITURA.
   110
   111
   112 IMPRESSAO.
   113    IF CT-LIN GREATER THAN 19
   114        PERFORM CABECALHO.
   115    PERFORM IMPDET.
* Microsoft COBOL Version 4.5        L2.4 revision 002 27-Apr-13 13:14 Page   3
*                                       EX03.CBL
   116
   117 IMPDET.
   118    MOVE CODIGO TO COD.
   119    MOVE NOME-ENT TO NOM.
   120    MOVE SALARIO     TO SAL.
   121    WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   122    ADD 1 TO CT-LIN.
   123    ADD 1 TO TOTCLI.
   124    ADD SALARIO TO TOTSAL.
   125
   126 CABECALHO.
   127    ADD 1 TO CT-PAG.
   128    MOVE CT-PAG TO VAR-PAG.
   129    MOVE SPACES TO REG-ATR.
   130    WRITE REG-ATR AFTER ADVANCING PAGE.
   131    WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   132    WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 1 LINES.
   133    WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 1 LINES.
   134    WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 2 LINES.
   135    MOVE ZEROES TO CT-LIN.
   136
   137
   138 FIM.
   139    MOVE TOTCLI TO TOTCL.
   140    WRITE REG-ATR FROM CAB-05 AFTER ADVANCING 1 LINES.
   141    MOVE TOTSAL TO TOTSA.
   142    WRITE REG-ATR FROM CAB-06 AFTER ADVANCING 1 LINES.
   143    CLOSE CADENT
   144          RELSAI.
   145
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1692     Code:         700     Dictionary:        1820
